{"ast":null,"code":"var _jsxFileName = \"/Users/mariyannikolov/Documents/GitHub/BG-Baba/src/components/item-details-page/ItemDetailsPage.js\",\n    _s = $RefreshSig$();\n\nimport styles from \"./ItemDetailsPage.module.css\";\nimport \"../../reset.css\";\nimport { useEffect } from \"react\";\nimport { useParams, Link, useNavigate } from \"react-router-dom\";\nimport * as itemsService from \"../../services/itemsService\";\nimport * as commentService from \"../../services/commentService\";\nimport { useItemContext } from \"../../contexts/ItemContext\";\nimport { useAuthContext } from \"../../contexts/AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ItemDetailsPage = () => {\n  _s();\n\n  var _currentItem$comments;\n\n  const {\n    itemId\n  } = useParams();\n  const {\n    user\n  } = useAuthContext(); // const { commentId } = useParams();\n\n  const navigate = useNavigate();\n  const {\n    addComment,\n    fetchItemDetails,\n    selectItem,\n    removeItem\n  } = useItemContext();\n  const currentItem = selectItem(itemId);\n  const isOwner = currentItem._ownerId === user._id;\n  useEffect(() => {\n    (async () => {\n      const itemDetails = await itemsService.getOne(itemId);\n      const itemComments = await commentService.getByItemId(itemId);\n      console.log(user._id == itemDetails._ownerId);\n      fetchItemDetails(itemId, { ...itemDetails,\n        comments: itemComments.map(x => `${x.user.email}: ${x.text}`)\n      });\n    })();\n  }, []);\n\n  const addCommentHandler = e => {\n    e.preventDefault();\n    const formData = new FormData(e.target);\n    const comment = formData.get(\"comment\");\n\n    if (comment === \"\") {\n      alert(\"Comment can not be empty!\");\n      return;\n    }\n\n    commentService.create(itemId, comment).then(result => {\n      addComment(itemId, comment);\n    });\n    e.target.reset();\n  }; // const deleteCommentHandler = (e) => {\n  //   e.preventDefault();\n  //   commentService.remove(commentId);\n  // }\n\n\n  const deleteItemHandler = () => {\n    const confirmation = window.confirm(\"Are you sure you want to delete the item?\");\n\n    if (confirmation) {\n      itemsService.remove(itemId).then(() => {\n        removeItem(itemId);\n        navigate(\"/items\");\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.mainWrapper,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.innerWrapper,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: styles.heading,\n        children: \"Item Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Item Type: \", currentItem.type]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        className: styles.img,\n        src: currentItem.img\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: [\"Size: \", currentItem.size]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: [\"Gender: \", currentItem.gender]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: [\"Price: \", currentItem.price]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Created By: \", currentItem.creator]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Creator's Phone Number: \", currentItem.phone]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), isOwner && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.btns,\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: `/items/${itemId}/edit`,\n          className: styles.editBtn,\n          children: \"Edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: deleteItemHandler,\n          className: styles.delBtn,\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.commentsWrapper,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: styles.commentsText,\n          children: \"Comments:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          role: \"list\",\n          children: (_currentItem$comments = currentItem.comments) === null || _currentItem$comments === void 0 ? void 0 : _currentItem$comments.map(x => /*#__PURE__*/_jsxDEV(\"li\", {\n            className: styles.comment,\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: x\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 17\n            }, this)\n          }, x, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this), !currentItem.comments && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"No comments.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 37\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.createComment,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Add new comment:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.commentFieldAndBtn,\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            className: styles.form,\n            onSubmit: addCommentHandler,\n            children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n              name: \"comment\",\n              placeholder: \"Comment......\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: styles.btnSubmit,\n              type: \"submit\",\n              value: \"Add Comment\",\n              disabled: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ItemDetailsPage, \"K5HB4rEYVMstVYyd5N1b0cD11oo=\", false, function () {\n  return [useParams, useAuthContext, useNavigate, useItemContext];\n});\n\n_c = ItemDetailsPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ItemDetailsPage\");","map":{"version":3,"names":["styles","useEffect","useParams","Link","useNavigate","itemsService","commentService","useItemContext","useAuthContext","ItemDetailsPage","itemId","user","navigate","addComment","fetchItemDetails","selectItem","removeItem","currentItem","isOwner","_ownerId","_id","itemDetails","getOne","itemComments","getByItemId","console","log","comments","map","x","email","text","addCommentHandler","e","preventDefault","formData","FormData","target","comment","get","alert","create","then","result","reset","deleteItemHandler","confirmation","window","confirm","remove","mainWrapper","innerWrapper","heading","type","img","size","gender","price","creator","phone","btns","editBtn","delBtn","commentsWrapper","commentsText","createComment","commentFieldAndBtn","form","btnSubmit"],"sources":["/Users/mariyannikolov/Documents/GitHub/BG-Baba/src/components/item-details-page/ItemDetailsPage.js"],"sourcesContent":["import styles from \"./ItemDetailsPage.module.css\";\nimport \"../../reset.css\";\nimport { useEffect } from \"react\";\nimport { useParams, Link, useNavigate } from \"react-router-dom\";\nimport * as itemsService from \"../../services/itemsService\";\nimport * as commentService from \"../../services/commentService\";\nimport { useItemContext } from \"../../contexts/ItemContext\";\nimport { useAuthContext } from \"../../contexts/AuthContext\";\n\nexport const ItemDetailsPage = () => {\n  const { itemId } = useParams();\n  const { user } = useAuthContext();\n\n  // const { commentId } = useParams();\n  const navigate = useNavigate();\n  const { addComment, fetchItemDetails, selectItem, removeItem } =\n    useItemContext();\n  const currentItem = selectItem(itemId);\n\n  const isOwner = currentItem._ownerId === user._id\n\n  useEffect(() => {\n    (async () => {\n      const itemDetails = await itemsService.getOne(itemId);\n      const itemComments = await commentService.getByItemId(itemId);\n\n      console.log(user._id == itemDetails._ownerId);\n\n      fetchItemDetails(itemId, {\n        ...itemDetails,\n        comments: itemComments.map((x) => `${x.user.email}: ${x.text}`),\n      });\n    })();\n  }, []);\n\n  const addCommentHandler = (e) => {\n    e.preventDefault();\n    const formData = new FormData(e.target);\n\n    const comment = formData.get(\"comment\");\n    if (comment === \"\") {\n      alert(\"Comment can not be empty!\");\n      return;\n    }\n\n    commentService.create(itemId, comment).then((result) => {\n      addComment(itemId, comment);\n    });\n    e.target.reset();\n  };\n\n  // const deleteCommentHandler = (e) => {\n  //   e.preventDefault();\n  //   commentService.remove(commentId);\n\n  // }\n\n  const deleteItemHandler = () => {\n    const confirmation = window.confirm(\n      \"Are you sure you want to delete the item?\"\n    );\n\n    if (confirmation) {\n      itemsService.remove(itemId).then(() => {\n        removeItem(itemId);\n        navigate(\"/items\");\n      });\n    }\n  };\n\n  return (\n    <div className={styles.mainWrapper}>\n      <div className={styles.innerWrapper}>\n        <h1 className={styles.heading}>Item Details</h1>\n        <h1>Item Type: {currentItem.type}</h1>\n        <img className={styles.img} src={currentItem.img} />\n        <h4>Size: {currentItem.size}</h4>\n        <h4>Gender: {currentItem.gender}</h4>\n        <h4>Price: {currentItem.price}</h4>\n        <h2>Created By: {currentItem.creator}</h2>\n        <h2>Creator's Phone Number: {currentItem.phone}</h2>\n\n        {isOwner && \n          <div className={styles.btns}>\n            <Link to={`/items/${itemId}/edit`} className={styles.editBtn}>\n              Edit\n            </Link>\n            <button onClick={deleteItemHandler} className={styles.delBtn}>\n              Delete\n            </button>\n          </div>\n        }\n         \n\n        <div className={styles.commentsWrapper}>\n          <h2 className={styles.commentsText}>Comments:</h2>\n          <ul role=\"list\">\n            {currentItem.comments?.map((x) => (\n              <li key={x} className={styles.comment}>\n                <p>{x}</p>\n                {/* <button onClick={deleteCommentHandler}>x</button> */}\n              </li>\n            ))}\n          </ul>\n\n          {!currentItem.comments && <p>No comments.</p>}\n        </div>\n        <div className={styles.createComment}>\n          <label>Add new comment:</label>\n          <div className={styles.commentFieldAndBtn}>\n            <form className={styles.form} onSubmit={addCommentHandler}>\n              <textarea name=\"comment\" placeholder=\"Comment......\" />\n\n              <input\n                className={styles.btnSubmit}\n                type=\"submit\"\n                value=\"Add Comment\"\n                disabled\n              />\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}